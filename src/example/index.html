<!DOCTYPE html>
<html>
<head>
    <title></title>
    <script type="text/javascript" data-main="Application" src="js/vendor/require.js"></script>
    <script type="text/javascript" src="js/monitoring.min.js"></script>
    <script type="text/javascript" src="js/vendor/bootstrap.min.js"></script>
    <script type="text/javascript" src="config.js"></script>
    <link rel="stylesheet" type="text/css" href="css/vendor/bootstrap.min.css" media="all" />
    <link rel="stylesheet" type="text/css" href="css/bootstrap-theme-monitor.css" media="all" />
</head>
<body>

<script type="text/javascript">
    requirejs.config({
        paths: {
            'jquery': '../js/vendor/jquery-2.0.3',
            'knockout': '../js/vendor/knockout-3.0.0',
            'moment': '../js/vendor/moment-with-langs.min'
        }
    });

    //initialize application
    require(['Application', 'knockout'], function(ApplicationViewModel, ko) {
        var applicationViewModel = new ApplicationViewModel(json);
        ko.applyBindings(applicationViewModel);
    });
</script>

<link data-bind="attr: {href: $root.getCss()}" rel="stylesheet" type="text/css" media="all" />

<!-- ko if: getTitle() -->
<h1 id="mainTitle" class="alert alert-info" data-bind="text: getTitle()"></h1>
<!-- /ko -->
<div id="content" data-bind="template: { name: 'section-template', foreach: getSections() }" ></div>

<script type="text/html" id="section-template">
    <div class="block">
        <div data-bind="attr: { id: title}">
            <!-- ko if: title -->
            <h2 class="alert alert-none">
                <!-- ko if: url -->
                <a class="alert-link" data-bind="attr: { href: url, title: title }, text: title"></a>
                <!-- /ko -->
                <!-- ko ifnot: url -->
                <span data-bind="text: title"></span>
                <!-- /ko -->
            </h2>
            <!-- /ko -->
            <!-- ko if: description -->
            <p data-bind="html: description"></p>
            <!-- /ko -->
            <!-- ko if: monitorModels -->
            <div class="panel-group" data-bind="template: { name: 'monitor-template', foreach: monitorModels, afterRender: $root.getData }"></div>
            <!-- /ko -->
            <!-- ko if: sections -->
            <div data-bind="template: { name: 'section-template', foreach: sections }"></div>
            <!-- /ko -->
        </div>
    </div>
</script>

<script type="text/html" id="monitor-template">
    <!-- ko if: $root.getTypes().isJenkins(getType()) -->
    <div class="panel panel-default">
        <div data-bind="attr: {style: getStyle()}, css: getCss(), pulsate: getCss()">
            <a class="alert-link" data-bind="attr: { href: getUrl(), title: getName() }, text: getName()"></a><br/>
            <span data-bind="text: getStartDate()"></span>
        </div>
        <div class="panel-collapse collapse">render more information here.</div>
    </div>
    <!-- /ko -->
    <!-- ko if: $root.getTypes().isNagios(getType()) -->
    <h3 data-bind="text: getName()"></h3>
    <div data-bind="template: { name: 'nagios-hostmodel-template', foreach: getHostmodels() }"></div>
    <!-- /ko -->
    <!-- ko if: $root.getTypes().isSonar(getType()) -->
    <div data-bind="template: { name: 'sonar-monitormodel-template' }"></div>
    <!-- /ko -->
</script>

<script type="text/html" id="nagios-hostmodel-template">
    <div class="panel panel-default">
        <div data-bind="css: getCss()">
            <a class="alert-link" data-bind="attr: { href: getUrl(), title: getHostname() }, text: getHostname()"></a><br/>
            <span data-bind="html: getText()"></span>
        </div>
    </div>
</script>

<script type="text/html" id="sonar-monitormodel-template">
    <h3><a class="alert-link" data-bind="attr: { href: getUrl(), title: getName() }, text: getName()"></a></h3>
    <table class="codeviolations">
        <thead>
        <tr>
            <th>Blocker</th>
            <th>Critical</th>
            <th>Major</th>
            <th>Minor</th>
            <th>Info</th>
            <th></th>
        </tr>
        </thead>
        <tbody data-bind="foreach: getViolationModels()"><tr data-bind="template: {name: 'sonar-violation-template', foreach: getViolations()}"></tr></tbody>
    </table>
</script>

<script type="text/html" id="sonar-violation-template">
    <td><div data-bind="css: getStatus(), text: getCount()"></div></td>
    <!-- ko if: ($index() === ($parent.getViolations().length - 1)) -->
    <th><a data-bind="attr: { href: $parent.getUrl(), title: $parent.getName() }, text: $parent.getName()"></a></th>
    <!-- /ko -->
</script>
</body>
</html>